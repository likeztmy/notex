import{c as J,r as h,d as b,j as m,e as K,w as Y,f as X}from"./index-MvcxFbVf.js";import{v as Z,x as Q,g as ee,y as te}from"./index-ek6y0BNb.js";import{C as vt,z as yt,E as wt,F as Rt,I as St,A as Ct,M as At,N as xt,B as Mt,G as Nt,R as Dt,H as Ot,J as Tt,K as It,L as jt,n as _t,O as Pt,Q as qt,U as Vt,V as kt,W as Ut,X as Bt,Y as Ft,Z as Lt,_ as zt,$ as $t,a0 as Gt,a1 as Wt,a2 as Ht,a3 as Jt,a4 as Kt,j as Yt,q as Xt,a5 as Zt,a6 as Qt,a7 as er,a8 as tr,a9 as rr,aa as nr,ab as sr,ac as ir,u as or,ad as ar,o as ur,ae as cr,af as lr,ag as dr,ah as hr,ai as fr,aj as pr,s as mr,d as Er,ak as br,c as gr,al as vr,am as yr,an as wr,ao as Rr,ap as Sr,aq as Cr,ar as Ar,as as xr,at as Mr,au as Nr,X as Dr,av as Or,aw as Tr,ax as Ir,ay as jr,b as _r,a as Pr,az as qr,aA as Vr,aB as kr,aC as Ur,aD as Br,aE as Fr,i as Lr,aF as zr,aG as $r,aH as Gr,aI as Wr,aJ as Hr,aK as Jr,aL as Kr,aM as Yr,aN as Xr,f as Zr,e as Qr,aO as en,m as tn,aP as rn,aQ as nn,aR as sn,aS as on,aT as an,aU as un,p as cn,aV as ln,aW as dn,aX as hn,r as fn,aY as pn,aZ as mn,a_ as En,a$ as bn,b0 as gn,b1 as vn,b2 as yn,t as wn,b3 as Rn,l as Sn,b4 as Cn,w as An}from"./index-ek6y0BNb.js";var L=J();const{getOwnPropertyNames:re,getOwnPropertySymbols:ne}=Object,{hasOwnProperty:se}=Object.prototype;function O(e,t){return function(r,s,i){return e(r,s,i)&&t(r,s,i)}}function M(e){return function(n,r,s){if(!n||!r||typeof n!="object"||typeof r!="object")return e(n,r,s);const{cache:i}=s,o=i.get(n),a=i.get(r);if(o&&a)return o===r&&a===n;i.set(n,r),i.set(r,n);const u=e(n,r,s);return i.delete(n),i.delete(r),u}}function ie(e){return e?.[Symbol.toStringTag]}function P(e){return re(e).concat(ne(e))}const oe=Object.hasOwn||((e,t)=>se.call(e,t));function y(e,t){return e===t||!e&&!t&&e!==e&&t!==t}const ae="__v",ue="__o",ce="_owner",{getOwnPropertyDescriptor:q,keys:V}=Object;function le(e,t){return e.byteLength===t.byteLength&&N(new Uint8Array(e),new Uint8Array(t))}function de(e,t,n){let r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n.equals(e[r],t[r],r,r,e,t,n))return!1;return!0}function he(e,t){return e.byteLength===t.byteLength&&N(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function fe(e,t){return y(e.getTime(),t.getTime())}function pe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function me(e,t){return e===t}function k(e,t,n){const r=e.size;if(r!==t.size)return!1;if(!r)return!0;const s=new Array(r),i=e.entries();let o,a,u=0;for(;(o=i.next())&&!o.done;){const E=t.entries();let f=!1,g=0;for(;(a=E.next())&&!a.done;){if(s[g]){g++;continue}const R=o.value,S=a.value;if(n.equals(R[0],S[0],u,g,e,t,n)&&n.equals(R[1],S[1],R[0],S[0],e,t,n)){f=s[g]=!0;break}g++}if(!f)return!1;u++}return!0}const Ee=y;function be(e,t,n){const r=V(e);let s=r.length;if(V(t).length!==s)return!1;for(;s-- >0;)if(!z(e,t,n,r[s]))return!1;return!0}function C(e,t,n){const r=P(e);let s=r.length;if(P(t).length!==s)return!1;let i,o,a;for(;s-- >0;)if(i=r[s],!z(e,t,n,i)||(o=q(e,i),a=q(t,i),(o||a)&&(!o||!a||o.configurable!==a.configurable||o.enumerable!==a.enumerable||o.writable!==a.writable)))return!1;return!0}function ge(e,t){return y(e.valueOf(),t.valueOf())}function ve(e,t){return e.source===t.source&&e.flags===t.flags}function U(e,t,n){const r=e.size;if(r!==t.size)return!1;if(!r)return!0;const s=new Array(r),i=e.values();let o,a;for(;(o=i.next())&&!o.done;){const u=t.values();let E=!1,f=0;for(;(a=u.next())&&!a.done;){if(!s[f]&&n.equals(o.value,a.value,o.value,a.value,e,t,n)){E=s[f]=!0;break}f++}if(!E)return!1}return!0}function N(e,t){let n=e.byteLength;if(t.byteLength!==n||e.byteOffset!==t.byteOffset)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}function ye(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function z(e,t,n,r){return(r===ce||r===ue||r===ae)&&(e.$$typeof||t.$$typeof)?!0:oe(t,r)&&n.equals(e[r],t[r],r,r,e,t,n)}const we="[object ArrayBuffer]",Re="[object Arguments]",Se="[object Boolean]",Ce="[object DataView]",Ae="[object Date]",xe="[object Error]",Me="[object Map]",Ne="[object Number]",De="[object Object]",Oe="[object RegExp]",Te="[object Set]",Ie="[object String]",je={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},_e="[object URL]",Pe=Object.prototype.toString;function qe({areArrayBuffersEqual:e,areArraysEqual:t,areDataViewsEqual:n,areDatesEqual:r,areErrorsEqual:s,areFunctionsEqual:i,areMapsEqual:o,areNumbersEqual:a,areObjectsEqual:u,arePrimitiveWrappersEqual:E,areRegExpsEqual:f,areSetsEqual:g,areTypedArraysEqual:R,areUrlsEqual:S,unknownTagComparators:D}){return function(c,l,d){if(c===l)return!0;if(c==null||l==null)return!1;const A=typeof c;if(A!==typeof l)return!1;if(A!=="object")return A==="number"?a(c,l,d):A==="function"?i(c,l,d):!1;const w=c.constructor;if(w!==l.constructor)return!1;if(w===Object)return u(c,l,d);if(Array.isArray(c))return t(c,l,d);if(w===Date)return r(c,l,d);if(w===RegExp)return f(c,l,d);if(w===Map)return o(c,l,d);if(w===Set)return g(c,l,d);const p=Pe.call(c);if(p===Ae)return r(c,l,d);if(p===Oe)return f(c,l,d);if(p===Me)return o(c,l,d);if(p===Te)return g(c,l,d);if(p===De)return typeof c.then!="function"&&typeof l.then!="function"&&u(c,l,d);if(p===_e)return S(c,l,d);if(p===xe)return s(c,l,d);if(p===Re)return u(c,l,d);if(je[p])return R(c,l,d);if(p===we)return e(c,l,d);if(p===Ce)return n(c,l,d);if(p===Se||p===Ne||p===Ie)return E(c,l,d);if(D){let x=D[p];if(!x){const _=ie(c);_&&(x=D[_])}if(x)return x(c,l,d)}return!1}}function Ve({circular:e,createCustomConfig:t,strict:n}){let r={areArrayBuffersEqual:le,areArraysEqual:n?C:de,areDataViewsEqual:he,areDatesEqual:fe,areErrorsEqual:pe,areFunctionsEqual:me,areMapsEqual:n?O(k,C):k,areNumbersEqual:Ee,areObjectsEqual:n?C:be,arePrimitiveWrappersEqual:ge,areRegExpsEqual:ve,areSetsEqual:n?O(U,C):U,areTypedArraysEqual:n?O(N,C):N,areUrlsEqual:ye,unknownTagComparators:void 0};if(t&&(r=Object.assign({},r,t(r))),e){const s=M(r.areArraysEqual),i=M(r.areMapsEqual),o=M(r.areObjectsEqual),a=M(r.areSetsEqual);r=Object.assign({},r,{areArraysEqual:s,areMapsEqual:i,areObjectsEqual:o,areSetsEqual:a})}return r}function ke(e){return function(t,n,r,s,i,o,a){return e(t,n,a)}}function Ue({circular:e,comparator:t,createState:n,equals:r,strict:s}){if(n)return function(a,u){const{cache:E=e?new WeakMap:void 0,meta:f}=n();return t(a,u,{cache:E,equals:r,meta:f,strict:s})};if(e)return function(a,u){return t(a,u,{cache:new WeakMap,equals:r,meta:void 0,strict:s})};const i={cache:void 0,equals:r,meta:void 0,strict:s};return function(a,u){return t(a,u,i)}}const Be=v();v({strict:!0});v({circular:!0});v({circular:!0,strict:!0});v({createInternalComparator:()=>y});v({strict:!0,createInternalComparator:()=>y});v({circular:!0,createInternalComparator:()=>y});v({circular:!0,createInternalComparator:()=>y,strict:!0});function v(e={}){const{circular:t=!1,createInternalComparator:n,createState:r,strict:s=!1}=e,i=Ve(e),o=qe(i),a=n?n(o):ke(o);return Ue({circular:t,comparator:o,createState:r,equals:a,strict:s})}var Fe=(...e)=>t=>{e.forEach(n=>{typeof n=="function"?n(t):n&&(n.current=t)})},Le=({contentComponent:e})=>{const t=L.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getServerSnapshot);return m.jsx(m.Fragment,{children:Object.values(t)})};function ze(){const e=new Set;let t={};return{subscribe(n){return e.add(n),()=>{e.delete(n)}},getSnapshot(){return t},getServerSnapshot(){return t},setRenderer(n,r){t={...t,[n]:X.createPortal(r.reactElement,r.element,n)},e.forEach(s=>s())},removeRenderer(n){const r={...t};delete r[n],t=r,e.forEach(s=>s())}}}var $e=class extends b.Component{constructor(e){var t;super(e),this.editorContentRef=b.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!((t=e.editor)!=null&&t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){var e;const t=this.props.editor;if(t&&!t.isDestroyed&&((e=t.view.dom)!=null&&e.parentNode)){if(t.contentComponent)return;const n=this.editorContentRef.current;n.append(...t.view.dom.parentNode.childNodes),t.setOptions({element:n}),t.contentComponent=ze(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=t.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),t.createNodeViews(),this.initialized=!0}}componentWillUnmount(){var e;const t=this.props.editor;if(t){this.initialized=!1,t.isDestroyed||t.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),t.contentComponent=null;try{if(!((e=t.view.dom)!=null&&e.parentNode))return;const n=document.createElement("div");n.append(...t.view.dom.parentNode.childNodes),t.setOptions({element:n})}catch{}}}render(){const{editor:e,innerRef:t,...n}=this.props;return m.jsxs(m.Fragment,{children:[m.jsx("div",{ref:Fe(t,this.editorContentRef),...n}),e?.contentComponent&&m.jsx(Le,{contentComponent:e.contentComponent})]})}},Ge=h.forwardRef((e,t)=>{const n=b.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[e.editor]);return b.createElement($e,{key:n,innerRef:t,...e})}),We=b.memo(Ge),He=typeof window<"u"?h.useLayoutEffect:h.useEffect,Je=class{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const t=()=>{this.transactionNumber+=1,this.subscribers.forEach(r=>r())},n=this.editor;return n.on("transaction",t),()=>{n.off("transaction",t)}}}};function Ke(e){var t;const[n]=h.useState(()=>new Je(e.editor)),r=Y.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,e.selector,(t=e.equalityFn)!=null?t:Be);return He(()=>n.watch(e.editor),[e.editor,n]),h.useDebugValue(r),r}var Ye=!1,T=typeof window>"u",Xe=T||!!(typeof window<"u"&&window.next),Ze=class ${constructor(t){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=t,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(t){this.editor=t,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?T||Xe?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const t={...this.options.current,onBeforeCreate:(...r)=>{var s,i;return(i=(s=this.options.current).onBeforeCreate)==null?void 0:i.call(s,...r)},onBlur:(...r)=>{var s,i;return(i=(s=this.options.current).onBlur)==null?void 0:i.call(s,...r)},onCreate:(...r)=>{var s,i;return(i=(s=this.options.current).onCreate)==null?void 0:i.call(s,...r)},onDestroy:(...r)=>{var s,i;return(i=(s=this.options.current).onDestroy)==null?void 0:i.call(s,...r)},onFocus:(...r)=>{var s,i;return(i=(s=this.options.current).onFocus)==null?void 0:i.call(s,...r)},onSelectionUpdate:(...r)=>{var s,i;return(i=(s=this.options.current).onSelectionUpdate)==null?void 0:i.call(s,...r)},onTransaction:(...r)=>{var s,i;return(i=(s=this.options.current).onTransaction)==null?void 0:i.call(s,...r)},onUpdate:(...r)=>{var s,i;return(i=(s=this.options.current).onUpdate)==null?void 0:i.call(s,...r)},onContentError:(...r)=>{var s,i;return(i=(s=this.options.current).onContentError)==null?void 0:i.call(s,...r)},onDrop:(...r)=>{var s,i;return(i=(s=this.options.current).onDrop)==null?void 0:i.call(s,...r)},onPaste:(...r)=>{var s,i;return(i=(s=this.options.current).onPaste)==null?void 0:i.call(s,...r)},onDelete:(...r)=>{var s,i;return(i=(s=this.options.current).onDelete)==null?void 0:i.call(s,...r)}};return new te(t)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(t){return this.subscriptions.add(t),()=>{this.subscriptions.delete(t)}}static compareOptions(t,n){return Object.keys(t).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&t.extensions&&n.extensions?t.extensions.length!==n.extensions.length?!1:t.extensions.every((s,i)=>{var o;return s===((o=n.extensions)==null?void 0:o[i])}):t[r]===n[r])}onRender(t){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&t.length===0?$.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(t),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(t){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=t;return}if(this.previousDeps.length===t.length&&this.previousDeps.every((r,s)=>r===t[s]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=t}scheduleDestroy(){const t=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===t){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===t&&this.setEditor(null))},1)}};function Qe(e={},t=[]){const n=h.useRef(e);n.current=e;const[r]=h.useState(()=>new Ze(n)),s=L.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return h.useDebugValue(s),h.useEffect(r.onRender(t)),Ke({editor:s,selector:({transactionNumber:i})=>e.shouldRerenderOnTransaction===!1||e.shouldRerenderOnTransaction===void 0?null:e.immediatelyRender&&i===0?0:i+1}),s}var I=h.createContext({editor:null}),et=I.Consumer,ct=()=>h.useContext(I);function lt({children:e,slotAfter:t,slotBefore:n,editorContainerProps:r={},...s}){const i=Qe(s),o=h.useMemo(()=>({editor:i}),[i]);return i?m.jsxs(I.Provider,{value:o,children:[n,m.jsx(et,{children:({editor:a})=>m.jsx(We,{editor:a,...r})}),e,t]}):null}var j=h.createContext({onDragStart:()=>{},nodeViewContentChildren:void 0,nodeViewContentRef:()=>{}}),dt=({children:e,content:t})=>h.createElement(j.Provider,{value:{nodeViewContentChildren:t}},e),G=()=>h.useContext(j);function ht({as:e="div",...t}){const{nodeViewContentRef:n,nodeViewContentChildren:r}=G();return m.jsx(e,{...t,ref:n,"data-node-view-content":"",style:{whiteSpace:"pre-wrap",...t.style},children:r})}var ft=b.forwardRef((e,t)=>{const{onDragStart:n}=G(),r=e.as||"div";return m.jsx(r,{...e,ref:t,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...e.style}})});function B(e){return!!(typeof e=="function"&&e.prototype&&e.prototype.isReactComponent)}function F(e){return!!(typeof e=="object"&&e.$$typeof&&(e.$$typeof.toString()==="Symbol(react.forward_ref)"||e.$$typeof.description==="react.forward_ref"))}function tt(e){return!!(typeof e=="object"&&e.$$typeof&&(e.$$typeof.toString()==="Symbol(react.memo)"||e.$$typeof.description==="react.memo"))}function rt(e){if(B(e)||F(e))return!0;if(tt(e)){const t=e.type;if(t)return B(t)||F(t)}return!1}function nt(){try{if(h.version)return parseInt(h.version.split(".")[0],10)>=19}catch{}return!1}var W=class{constructor(e,{editor:t,props:n={},as:r="div",className:s=""}){this.ref=null,this.destroyed=!1,this.id=Math.floor(Math.random()*4294967295).toString(),this.component=e,this.editor=t,this.props=n,this.element=document.createElement(r),this.element.classList.add("react-renderer"),s&&this.element.classList.add(...s.split(" ")),this.editor.isInitialized?K.flushSync(()=>{this.render()}):queueMicrotask(()=>{this.destroyed||this.render()})}render(){var e;if(this.destroyed)return;const t=this.component,n=this.props,r=this.editor,s=nt(),i=rt(t),o={...n};o.ref&&!(s||i)&&delete o.ref,!o.ref&&(s||i)&&(o.ref=a=>{this.ref=a}),this.reactElement=m.jsx(t,{...o}),(e=r?.contentComponent)==null||e.setRenderer(this.id,this)}updateProps(e={}){this.destroyed||(this.props={...this.props,...e},this.render())}destroy(){var e;this.destroyed=!0;const t=this.editor;(e=t?.contentComponent)==null||e.removeRenderer(this.id);try{this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)}catch{}}updateAttributes(e){Object.keys(e).forEach(t=>{this.element.setAttribute(t,e[t])})}},H=b.createContext({markViewContentRef:()=>{}}),pt=e=>{const{as:t="span",...n}=e,{markViewContentRef:r}=b.useContext(H);return m.jsx(t,{...n,ref:r,"data-mark-view-content":""})},st=class extends Z{constructor(e,t,n){super(e,t,n);const{as:r="span",attrs:s,className:i=""}=n||{},o={...t,updateAttributes:this.updateAttributes.bind(this)};this.contentDOMElement=document.createElement("span");const u={markViewContentRef:f=>{f&&!f.contains(this.contentDOMElement)&&f.appendChild(this.contentDOMElement)}},E=b.memo(f=>m.jsx(H.Provider,{value:u,children:b.createElement(e,f)}));E.displayName="ReactMarkView",this.renderer=new W(E,{editor:t.editor,props:o,as:r,className:`mark-${t.mark.type.name} ${i}`.trim()}),s&&this.renderer.updateAttributes(s)}get dom(){return this.renderer.element}get contentDOM(){return this.contentDOMElement}};function mt(e,t={}){return n=>new st(e,n,t)}var it=class extends Q{constructor(e,t,n){if(super(e,t,n),this.selectionRafId=null,!this.node.isLeaf){this.options.contentDOMElementTag?this.contentDOMElement=document.createElement(this.options.contentDOMElementTag):this.contentDOMElement=document.createElement(this.node.isInline?"span":"div"),this.contentDOMElement.dataset.nodeViewContentReact="",this.contentDOMElement.dataset.nodeViewWrapper="",this.contentDOMElement.style.whiteSpace="inherit";const r=this.dom.querySelector("[data-node-view-content]");if(!r)return;r.appendChild(this.contentDOMElement)}}mount(){const e={editor:this.editor,node:this.node,decorations:this.decorations,innerDecorations:this.innerDecorations,view:this.view,selected:!1,extension:this.extension,HTMLAttributes:this.HTMLAttributes,getPos:()=>this.getPos(),updateAttributes:(u={})=>this.updateAttributes(u),deleteNode:()=>this.deleteNode(),ref:h.createRef()};if(!this.component.displayName){const u=E=>E.charAt(0).toUpperCase()+E.substring(1);this.component.displayName=u(this.extension.name)}const r={onDragStart:this.onDragStart.bind(this),nodeViewContentRef:u=>{u&&this.contentDOMElement&&u.firstChild!==this.contentDOMElement&&(u.hasAttribute("data-node-view-wrapper")&&u.removeAttribute("data-node-view-wrapper"),u.appendChild(this.contentDOMElement))}},s=this.component,i=h.memo(u=>m.jsx(j.Provider,{value:r,children:h.createElement(s,u)}));i.displayName="ReactNodeView";let o=this.node.isInline?"span":"div";this.options.as&&(o=this.options.as);const{className:a=""}=this.options;this.handleSelectionUpdate=this.handleSelectionUpdate.bind(this),this.renderer=new W(i,{editor:this.editor,props:e,as:o,className:`node-${this.node.type.name} ${a}`.trim()}),this.editor.on("selectionUpdate",this.handleSelectionUpdate),this.updateElementAttributes()}get dom(){var e;if(this.renderer.element.firstElementChild&&!((e=this.renderer.element.firstElementChild)!=null&&e.hasAttribute("data-node-view-wrapper")))throw Error("Please use the NodeViewWrapper component for your node view.");return this.renderer.element}get contentDOM(){return this.node.isLeaf?null:this.contentDOMElement}handleSelectionUpdate(){this.selectionRafId&&(cancelAnimationFrame(this.selectionRafId),this.selectionRafId=null),this.selectionRafId=requestAnimationFrame(()=>{this.selectionRafId=null;const{from:e,to:t}=this.editor.state.selection,n=this.getPos();if(typeof n=="number")if(e<=n&&t>=n+this.node.nodeSize){if(this.renderer.props.selected)return;this.selectNode()}else{if(!this.renderer.props.selected)return;this.deselectNode()}})}update(e,t,n){const r=s=>{this.renderer.updateProps(s),typeof this.options.attrs=="function"&&this.updateElementAttributes()};if(e.type!==this.node.type)return!1;if(typeof this.options.update=="function"){const s=this.node,i=this.decorations,o=this.innerDecorations;return this.node=e,this.decorations=t,this.innerDecorations=n,this.options.update({oldNode:s,oldDecorations:i,newNode:e,newDecorations:t,oldInnerDecorations:o,innerDecorations:n,updateProps:()=>r({node:e,decorations:t,innerDecorations:n})})}return e===this.node&&this.decorations===t&&this.innerDecorations===n||(this.node=e,this.decorations=t,this.innerDecorations=n,r({node:e,decorations:t,innerDecorations:n})),!0}selectNode(){this.renderer.updateProps({selected:!0}),this.renderer.element.classList.add("ProseMirror-selectednode")}deselectNode(){this.renderer.updateProps({selected:!1}),this.renderer.element.classList.remove("ProseMirror-selectednode")}destroy(){this.renderer.destroy(),this.editor.off("selectionUpdate",this.handleSelectionUpdate),this.contentDOMElement=null,this.selectionRafId&&(cancelAnimationFrame(this.selectionRafId),this.selectionRafId=null)}updateElementAttributes(){if(this.options.attrs){let e={};if(typeof this.options.attrs=="function"){const t=this.editor.extensionManager.attributes,n=ee(this.node,t);e=this.options.attrs({node:this.node,HTMLAttributes:n})}else e=this.options.attrs;this.renderer.updateAttributes(e)}}};function Et(e,t){return n=>n.editor.contentComponent?new it(e,n,t):{}}export{vt as CommandManager,te as Editor,et as EditorConsumer,We as EditorContent,I as EditorContext,lt as EditorProvider,yt as Extendable,wt as Extension,Rt as Fragment,St as InputRule,Ct as MappablePosition,At as Mark,Z as MarkView,pt as MarkViewContent,xt as Node,Mt as NodePos,Q as NodeView,ht as NodeViewContent,ft as NodeViewWrapper,Nt as PasteRule,$e as PureEditorContent,st as ReactMarkView,H as ReactMarkViewContext,mt as ReactMarkViewRenderer,it as ReactNodeView,dt as ReactNodeViewContentProvider,j as ReactNodeViewContext,Et as ReactNodeViewRenderer,W as ReactRenderer,Dt as ResizableNodeView,Ot as ResizableNodeview,Tt as Tracker,It as callOrReturn,jt as canInsertNode,_t as combineTransactionSteps,Pt as commands,qt as createAtomBlockMarkdownSpec,Vt as createBlockMarkdownSpec,kt as createChainableState,Ut as createDocument,Bt as createElement,Ft as createInlineMarkdownSpec,Lt as createMappablePosition,zt as createNodeFromContent,$t as createStyleTag,Gt as defaultBlockAt,Wt as deleteProps,Ht as elementFromString,Jt as escapeForRegEx,Kt as extensions,Yt as findChildren,Xt as findChildrenInRange,Zt as findDuplicates,Qt as findParentNode,er as findParentNodeClosestToPos,tr as flattenExtensions,rr as fromString,nr as generateHTML,sr as generateJSON,ir as generateText,or as getAttributes,ar as getAttributesFromExtensions,ur as getChangedRanges,cr as getDebugJSON,lr as getExtensionField,dr as getHTMLFromFragment,hr as getMarkAttributes,fr as getMarkRange,pr as getMarkType,mr as getMarksBetween,Er as getNodeAtPosition,br as getNodeAttributes,gr as getNodeType,ee as getRenderedAttributes,vr as getSchema,yr as getSchemaByResolvedExtensions,wr as getSchemaTypeByName,Rr as getSchemaTypeNameByName,Sr as getSplittedAttributes,Cr as getText,Ar as getTextBetween,xr as getTextContentFromNodes,Mr as getTextSerializersFromSchema,Nr as getUpdatedPosition,Dr as h,Or as injectExtensionAttributesToParseRule,Tr as inputRulesPlugin,Ir as isActive,jr as isAndroid,_r as isAtEndOfNode,Pr as isAtStartOfNode,qr as isEmptyObject,Vr as isExtensionRulesEnabled,kr as isFunction,Ur as isList,Br as isMacOS,Fr as isMarkActive,Lr as isNodeActive,zr as isNodeEmpty,$r as isNodeSelection,Gr as isNumber,Wr as isPlainObject,Hr as isRegExp,Jr as isSafari,Kr as isString,Yr as isTextSelection,Xr as isiOS,Zr as markInputRule,Qr as markPasteRule,en as markdown,tn as mergeAttributes,rn as mergeDeep,nn as minMax,sn as nodeInputRule,on as nodePasteRule,an as objectIncludes,un as parseAttributes,cn as parseIndentedBlocks,ln as pasteRulesPlugin,dn as posToDOMRect,hn as removeDuplicates,fn as renderNestedMarkdownContent,pn as resolveExtensions,mn as resolveFocusPosition,En as rewriteUnknownContent,bn as selectionToInsertionEnd,gn as serializeAttributes,vn as sortExtensions,yn as splitExtensions,wn as textInputRule,Rn as textPasteRule,Sn as textblockTypeInputRule,Cn as updateMarkViewAttributes,ct as useCurrentEditor,Qe as useEditor,Ke as useEditorState,G as useReactNodeView,An as wrappingInputRule};
